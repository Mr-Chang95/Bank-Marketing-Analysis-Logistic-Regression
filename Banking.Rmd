---
title: "bank"
author: "Daniel Chang"
date: "2023-04-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Data and Packages

```{r bank}
library(tidyverse)
library(GGally)
library(skimr)
library(reshape2) 

bank = read.csv("bank-full.csv", stringsAsFactors = T)
head(bank)
```

```{r}
summary(bank)
```

```{r}
# Look at structure
str(bank)

# Skim the dataset
skim(bank)
```
### Check for missing values 
No NAs in data
```{r}
colSums(is.na(bank))
sum(is.na(bank))
```

## Exploratory Data Analysis(EDA)
### Visual EDA

```{r EDA, message = F}
# Job Count
ggplot(bank, aes(x = job, fill = y)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

# Education Count
ggplot(bank, aes(x = education, fill = y)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

# Age Distribution
ggplot(bank, aes(x = age, fill = y)) +
  geom_histogram(bins = 50)

# Duration Distribution
ggplot(bank, aes(x = duration, fill = y)) +
  geom_histogram(bins = 50)

# Balance Distribution
ggplot(bank, aes(x = balance, fill = y)) +
  geom_histogram(bins = 20)

# Balance Boxplot
ggplot(bank, aes(x = balance, y =y, fill = y)) +
  geom_boxplot()

# Housing Count
ggplot(bank, aes(x = housing, fill = y)) +
  geom_bar()

# Loan 
ggplot(data = bank, aes(x = loan , y = y, fill = y)) + 
  geom_bar(stat = 'identity', position = 'dodge') + 
  xlab("Loan")+ylab("Response")

# Marital Status 
ggplot(data = bank, aes(x = marital, y = y, fill = y)) + 
  geom_bar(stat = 'identity', position = 'dodge') + 
  xlab("Marital")+ylab("Response")

# Default
ggplot(data = bank, aes(x = default , y = y, fill = y)) + 
  geom_bar(stat = 'identity', position = 'dodge') + 
  xlab("Default")+ylab("Response")

# Default
ggplot(data = bank, aes(x = poutcome , y = y, fill = y)) + 
  geom_bar(stat = 'identity', position = 'dodge') + 
  xlab("Poutcome")+ylab("Response")

# Previous 
ggplot(data = bank, aes(x = previous, fill = y)) +
  geom_histogram() +
  labs(title = "Distribution of Previous Campaign", x = "Previous Campaign", y = "Count")
```

### Correlation Matrix
```{r Corr Matrix, message = FALSE}
# make new numeric column for "y" column
bank$y_num = num(ifelse(bank$y == "yes",1,0))

## Correlation map
num_cols = unlist(lapply(bank, is.numeric))
data_num = bank[ , num_cols] 
corr_mat <- round(cor(data_num),2)
 
# reduce the size of correlation matrix
melted_corr_mat <- melt(corr_mat)
# head(melted_corr_mat)
 
# plotting the correlation heatmap
ggplot(data = melted_corr_mat, aes(x=Var1, y=Var2,
                                   fill=value)) +
geom_tile() +
geom_text(aes(Var2, Var1, label = value),
          color = "white", size = 4) +
  ggtitle("Heatmap of Correalation For Numeric Variables")

# ggpairs
ggpairs(data_num)
```
